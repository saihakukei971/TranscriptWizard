# TranscriptWizard - 音声文字起こし・議事録自動化ツール

## 概要

このツールは、会議やセミナー、インタビューなどの音声を自動的に文字起こしし、さらにAIによる要約で議事録を作成するシステムです。Google Colabを使わず、お手元のパソコンで完結して使用できます。

## 主な機能

* Whisperモデルによる高精度な音声文字起こし
* GPTによる議事録・要約の自動生成
* 複数の音声・動画フォーマットに対応（mp3, wav, m4a, mp4など）
* 全ての処理をローカルまたはAPIで完結（安全性が高い）
* Slack通知機能（オプション）
* 処理ログの自動作成

## 配布パッケージ内容

配布用Zipファイルには以下のファイルを含めています：

1. `TranscriptWizard.exe` - メイン実行ファイル
2. `README.md` - 使用方法の説明書
3. `@env.template` - APIキー設定用テンプレート（※ユーザーが`.env`にリネームして使用）
4. `ffmpeg` - フォルダ（音声処理に必要なライブラリ一式）
5. `sample.mp3` - サンプル音声ファイル（テスト用）
6. `LICENSE` - ライセンスファイル
7. `SECURITY.md` - セキュリティガイドライン

## @env.templateの内容と使用方法

```
# TranscriptWizard 設定ファイル
# このファイルを「.env」にリネームして使用してください
# （例：「@env.template」→「.env」）

# OpenAI APIキー
# https://platform.openai.com/api-keys から取得できます
OPENAI_API_KEY=sk-XXXXXXXXXXXXXXXXXXXXXXXXXXXX

# Slack通知用Webhook URL（オプション）
# 通知が必要ない場合はこのままで構いません
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/XXX/YYY/ZZZ

# Whisperモデルサイズ（tiny/base/small/medium/large）
# 推奨: small（バランスが良い）, medium（高精度だがメモリ使用量増）
WHISPER_MODEL_SIZE=small
```

### 設定ファイルの使用手順

1. 配布パッケージ内の `@env.template` ファイルを見つけます
2. このファイルをコピーして `.env` という名前に変更します
   - Windows: ファイルを右クリック→「名前の変更」→`.env`と入力
   - Mac: ファイルを選択→Enter→`.env`と入力
3. テキストエディタで`.env`ファイルを開き、必要な設定を行います
4. 特に `OPENAI_API_KEY=` の後に、あなたのOpenAI APIキーを入力します
5. 保存後、TranscriptWizardを起動すると設定が適用されます

**注意**: ファイル名の先頭がドット(.)のファイルはシステムファイルとして扱われるため、エクスプローラーで表示されない場合があります。「表示」→「隠しファイルの表示」をオンにすると確認できます。

## 初期セットアップ

1. 配布されたZipファイルを任意の場所に解凍します。
2. `@env.template` ファイルを `.env` にリネームします。
   - Windows: ファイルを右クリック→「名前の変更」→`.env`と入力
   - Mac: ファイルを選択→Enter→`.env`と入力
   - **注意**: ファイル名の先頭がドット(.)のファイルはシステムファイルとして扱われるため、エクスプローラーで表示されない場合があります。「表示」→「隠しファイルの表示」をオンにすると確認できます。
3. `.env` ファイルをテキストエディタで開き、OpenAI APIキーを設定します。
   - APIキーの取得方法:
     1. [OpenAIのウェブサイト](https://platform.openai.com/signup)でアカウント作成
     2. [APIキーページ](https://platform.openai.com/api-keys)で「Create new secret key」をクリック
     3. 生成されたAPIキーをコピー
4. `.env` ファイルを保存して閉じます。
5. `TranscriptWizard.exe` をダブルクリックして起動します。
6. 初回起動時にffmpegが自動設定され、必要なモデルがダウンロードされます。

## 使用方法

### 基本的な使い方

1. 文字起こししたい音声・動画ファイルを、TranscriptWizard.exeと同じフォルダに配置します。
2. 対応形式: mp3, wav, m4a, mp4
3. ファイル名で処理順序を制御できます（例: 01_会議.mp3, 02_質疑応答.mp3）
4. TranscriptWizard.exeをダブルクリックで起動します。
5. フォルダ内の音声ファイルが自動的に検出され、処理が開始されます。
6. 進捗状況はコンソール画面に表示されます。

### 出力ファイル

処理が完了すると、以下のファイルが生成されます:

* `{元ファイル名}_文字起こし.txt`: Whisperによる文字起こし結果
* `{元ファイル名}_議事録.docx`: GPTによる要約・議事録（議題、要点、決定事項、ToDo形式）
* `transcription_log.csv`: 処理ログ（ファイル名、処理時間、文字数などを記録）

### 複数ファイルの一括処理

1. 複数の音声/動画ファイルを同時に処理できます。
2. ファイル名の先頭に番号を付けると処理順を制御できます:
   ```
   01_開会挨拶.mp3
   02_プレゼンテーション.mp3
   03_質疑応答.mp3
   ```
3. 処理は上記の順番で行われます。

### 長時間音声の効率的な処理

1. 2時間を超える長時間音声は、30分〜1時間ごとに分割することをお勧めします。
2. 分割方法:
   - 録音時に定期的に停止・再開する
   - 音声編集ソフト（Audacityなど）で分割する
3. 分割したファイルを順番に処理することで、全体の処理時間を短縮できます。

### Slack通知の設定（オプション）

1. Slackで通知を受け取りたい場合は、Webhook URLを設定します。
2. `.env`ファイル内の`SLACK_WEBHOOK_URL=`の後にWebhook URLを入力します。
3. 処理が完了すると、指定したSlackチャンネルに通知が送信されます。

## 処理時間の目安

| 会議の長さ | 音声長（分） | Whisper処理時間 | GPT要約時間 | 合計処理時間（目安） |
|------------|--------------|-----------------|------------|----------------------|
| 30分       | 約30分       | 15分（CPU）     | 5秒〜30秒  | 約15〜16分          |
| 1時間      | 約60分       | 30分            | 最大1分    | 約30〜32分          |
| 2時間      | 約120分      | 約60分          | 最大2分    | 約60〜65分          |

※ パソコンの性能により変動します。GPUがある場合は大幅に高速化されます。

## 複数ファイル処理の運用指針

### 対応形式
mp3, m4a, wav, mp4

### 処理モード
1. **1個ずつ順番処理**
   - ファイル名昇順（例：01_〜、02_〜）で自動処理
   - 推奨教育内容：ファイル名を「01_」などで昇順に命名させる

2. **一括処理**
   - まとめて順番に実行
   - 推奨教育内容：会議名や日付で分けたフォルダにファイルをまとめること

### ユーザー教育の推奨指針
- 1会議ごとにファイルをフォルダにまとめる
- 優先順位の高い音声はファイル名の先頭に「01_〜」などの番号をつける
- 処理完了後はファイルを退避する運用

## 広告代理店での活用例

### 1. クライアントインタビューの効率化

**状況**：新規クライアントとの初回ミーティング後、企画チームは詳細なブリーフを作成する必要がある

**従来の方法**：会議中にメモを取り、後で記憶を頼りに要点をまとめる→情報の欠落や誤解が発生

**TranscriptWizard活用後**：
1. ミーティングを録音（クライアントの許可を得る）
2. TranscriptWizardで文字起こしと要約を自動生成
3. 要約を基にブリーフを効率的に作成
4. 詳細な文字起こしを参照して、クライアントの言葉そのままを企画に反映

**効果**：
- ブリーフ作成時間を50%削減
- クライアントの意図を正確に把握
- 企画の的確性向上

### 2. コピーライティングセッションの記録

**状況**：広告キャッチコピーを考えるブレインストーミングセッション

**従来の方法**：ホワイトボードやノートに案を書き留める→良いアイデアが見落とされる

**TranscriptWizard活用後**：
1. セッションを録音
2. TranscriptWizardで全ての発言を文字に起こす
3. GPTによる要約で「キャッチコピー候補」をリスト化
4. チームで文字起こしを見直し、記録されていなかった良いアイデアを発掘

**効果**：
- 創造的なアイデアを漏れなく記録
- 議論の流れを振り返り、さらに発展させられる
- クリエイティブプロセスの質向上

### 3. ユーザーテスト結果の分析

**状況**：新しいウェブサイトデザインのユーザビリティテスト実施後の分析

**従来の方法**：観察ノートとアンケート結果を手動で集計→主観が入りやすく時間もかかる

**TranscriptWizard活用後**：
1. テスト中のユーザーの声を録音
2. TranscriptWizardで文字起こしと要約を自動生成
3. 要約から主要な課題点とポジティブフィードバックを抽出
4. デザイン改善に直接反映

**効果**：
- ユーザーの言葉をそのまま記録できる
- 感情面も含めたフィードバックの正確な把握
- 改善点の客観的な優先順位付け

### 4. マーケティング戦略会議の記録

**状況**：四半期ごとのマーケティング戦略会議で多数の意思決定が必要

**従来の方法**：会議中にスライドとメモで記録→決定事項の詳細が曖昧になりがち

**TranscriptWizard活用後**：
1. 会議を録音
2. TranscriptWizardで文字起こしと要約（特に【決定事項】【ToDo】の部分）を自動生成
3. 自動生成された議事録を全員に共有
4. 決定事項と担当者の明確な記録

**効果**：
- 会議の効率向上（記録係が不要に）
- 決定事項の透明性と追跡可能性向上
- チーム間の情報共有の正確性向上

### 5. トレンド分析レポートの作成

**状況**：業界エキスパートとのインタビューを基にトレンド分析レポートを作成

**従来の方法**：インタビュー中のメモ取りと記憶を頼りにレポート作成→重要な洞察が抜け落ちる

**TranscriptWizard活用後**：
1. エキスパートインタビューを録音
2. TranscriptWizardで詳細な文字起こしと要約を生成
3. 要約を骨子としてレポートを展開
4. 詳細な文字起こしから正確な引用を抽出

**効果**：
- レポート作成時間の大幅短縮
- エキスパートの洞察を正確に捉えた質の高いレポート
- 客観的なデータに基づく分析

## セキュリティ設計

TranscriptWizardは、以下の点でセキュリティに配慮しています:

1. **ローカル処理優先**:
   - 音声ファイルはローカルで処理（音声データがインターネットに送信されない）
   - Whisperモデルはローカル実行

2. **最小限のデータ送信**:
   - OpenAI APIには文字起こしテキストのみを送信
   - 音声そのものは外部サーバーに送信されない

3. **APIキー管理**:
   - APIキーはローカルの`.env`ファイルに保存
   - 外部への送信なし

4. **データの自動消去**:
   - 一時ファイルは処理後に自動削除
   - セッション単位でファイルが消去される設計

5. **透明性**:
   - 全処理のログを記録
   - 送信されるデータの内容が明示的

これにより、機密性の高い社内会議の処理にも安心して利用できます。
（各サービスの利用規約を確認の上で使用してください。）

## トラブルシューティング

### よくある問題と解決策

1. **起動しない**
   - 原因: .envファイルが破損している可能性があります
   - 解決策: .envファイルを削除し、再度実行してAPIキーを入力してください
   - 追加対応: 管理者権限で実行してみる

2. **「ffmpegが見つかりません」エラー**
   - 原因: ffmpegがインストールされていないか、PATHが設定されていません
   - 解決策: [ffmpeg公式サイト](https://ffmpeg.org/download.html)からffmpegをダウンロード・インストールするか、Chocolateyを使用している場合は`choco install ffmpeg -y`でインストールしてください
   - 追加対応: 
     - Windows: 環境変数PATHにffmpegのbinフォルダを追加
     - Mac: `brew install ffmpeg`でインストール

3. **処理が途中で止まる**
   - 原因: メモリ不足や音声ファイルの問題の可能性があります
   - 解決策: 大きな音声ファイルは小さく分割してみてください
   - 追加対応: 小さいWhisperモデル（tinyまたはbase）を試す

4. **文字化けが発生する**
   - 原因: エンコーディングの問題です
   - 解決策: テキストエディタでUTF-8を指定して開いてください
   - 追加対応: Windowsのメモ帳ではなく、VS CodeやNotepad++などのエディタを使用

5. **GPTによる要約が失敗する**
   - 原因: APIキーが無効か、クレジットが不足している可能性があります
   - 解決策: OpenAIのダッシュボードでAPIキーとクレジット残高を確認してください
   - 追加対応: サブスクリプションの支払い状況を確認

6. **処理が遅い**
   - 原因: CPUのみでの処理、またはコンピュータのリソース不足
   - 解決策: GPU対応環境で実行するか、小さいWhisperモデルを使用
   - 追加対応: バックグラウンドアプリケーションを閉じてリソースを確保

### エラーログの確認方法

トラブル発生時は、以下のログファイルを確認してください:
1. `transcriber.log` - 詳細な処理ログ
2. `transcription_log.csv` - 処理結果の概要

## システム要件

* Windows 10/11（64bit）または macOS 10.15以降
* 4GB以上のRAM（8GB以上推奨）
* 2GB以上の空き容量（Whisperモデルのダウンロード用）
* インターネット接続（初回実行時とGPT API利用時）
* Python 3.9以上（ソースコードから実行する場合）

## 免責事項

* 本ツールは無保証で提供されます
* 文字起こしや要約の精度は、音声の品質や内容によって変動します
* OpenAI APIの利用には別途料金が発生します
* 機密性の高い情報を処理する場合は、自己責任でご利用ください
* 録音前に必ず関係者の同意を得てください

## バージョン情報

* Version 1.0.0 (2025/05/05)
  - 初回リリース
  - Whisper small/medium/largeモデル対応
  - GPT-4o / GPT-3.5-turbo による要約機能
  - Slack通知機能
